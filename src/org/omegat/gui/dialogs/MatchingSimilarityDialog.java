/**************************************************************************
 OmegaT - Java based Computer Assisted Translation (CAT) tool
 Copyright (C) 2002-2004  Keith Godfrey et al
                          keithgodfrey@users.sourceforge.net
                          907.223.2039

 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 2 of the License, or
 (at your option) any later version.

 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software
 Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
**************************************************************************/

package org.omegat.gui.dialogs;

import org.omegat.util.OStrings;

import java.awt.*;
import java.awt.event.ActionListener;
import java.awt.event.WindowEvent;
import java.awt.event.WindowAdapter;
import java.awt.event.ActionEvent;
import javax.swing.*;

/**
 *
 * @author  Maxym Mykhalchuk
 */
public class MatchingSimilarityDialog extends JDialog
{
	/** Creates new form MatchingSimilarityDialog */
	public MatchingSimilarityDialog(Frame parent, String nearTrash)
	{
		super(parent);
		initComponents();
		value = (int)Math.round( 5 * (Double.parseDouble(nearTrash) - 0.2) );
		similaritySlider.setValue(value);
		pack();
	}
	
	private boolean changed;
	/** @return if the user changed similarity coefficient and pressed OK */
	public boolean isChanged()
	{
		return changed;
	}

	private int value;
	/** @return trash number */
	public String getNearTrash()
	{
		switch( value )
		{
			case 0:
				return "0.2";													// NOI18N
			case 1:
				return "0.4";													// NOI18N
			case 2:
			default:
				return "0.6";													// NOI18N
		}
	}
	
	
	/** This method is called from within the constructor to
	 * initialize the form.
	 * WARNING: Do NOT modify this code. The content of this method is
	 * always regenerated by the Form Editor.
	 */
    private void initComponents()//GEN-BEGIN:initComponents
    {
        GridBagConstraints gridBagConstraints;

        buttonPanel = new JPanel();
        okButton = new JButton();
        cancelButton = new JButton();
        descriptionText = new JTextArea();
        similaritySlider = new JSlider();
        captionsPanel = new JPanel();
        minLabel = new JLabel();
        normLabel = new JLabel();
        maxLabel = new JLabel();
        jLabel1 = new JLabel();
        jLabel2 = new JLabel();

        getContentPane().setLayout(new GridBagLayout());

        setTitle(OStrings.getString("MS_TITLE"));
        setModal(true);
        setResizable(false);
        addWindowListener(new WindowAdapter()
        {
            public void windowClosing(WindowEvent evt)
            {
                closeDialog();
            }
        });

        buttonPanel.setLayout(new FlowLayout(FlowLayout.RIGHT));

        okButton.setText(OStrings.getString("BUTTON_OK"));
        okButton.addActionListener(new ActionListener()
        {
            public void actionPerformed(ActionEvent evt)
            {
                okButtonActionPerformed();
            }
        });

        buttonPanel.add(okButton);

        cancelButton.setText(OStrings.getString("BUTTON_CANCEL"));
        cancelButton.addActionListener(new ActionListener()
        {
            public void actionPerformed(ActionEvent evt)
            {
                cancelButtonActionPerformed();
            }
        });

        buttonPanel.add(cancelButton);

        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        getContentPane().add(buttonPanel, gridBagConstraints);

        descriptionText.setBackground(UIManager.getDefaults().getColor("Label.background"));
        descriptionText.setEditable(false);
        descriptionText.setFont(maxLabel.getFont());
        descriptionText.setLineWrap(true);
        descriptionText.setText(OStrings.getString("MS_DESCRIPTION"));
        descriptionText.setWrapStyleWord(true);
        descriptionText.setDisabledTextColor(UIManager.getDefaults().getColor("Label.foreground"));
        descriptionText.setEnabled(false);
        descriptionText.setMinimumSize(new Dimension(200, 100));
        descriptionText.setOpaque(false);
        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.fill = GridBagConstraints.BOTH;
        gridBagConstraints.anchor = GridBagConstraints.NORTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new Insets(4, 4, 4, 4);
        getContentPane().add(descriptionText, gridBagConstraints);

        similaritySlider.setMajorTickSpacing(1);
        similaritySlider.setMaximum(2);
        similaritySlider.setPaintTicks(true);
        similaritySlider.setSnapToTicks(true);
        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new Insets(4, 10, 0, 10);
        getContentPane().add(similaritySlider, gridBagConstraints);

        captionsPanel.setLayout(new GridLayout(2, 3, 30, 0));

        minLabel.setHorizontalAlignment(SwingConstants.LEFT);
        minLabel.setText(OStrings.getString("MS_LABEL_MIN"));
        captionsPanel.add(minLabel);

        normLabel.setHorizontalAlignment(SwingConstants.CENTER);
        normLabel.setText(OStrings.getString("MS_LABEL_LOW"));
        captionsPanel.add(normLabel);

        maxLabel.setHorizontalAlignment(SwingConstants.TRAILING);
        maxLabel.setText(OStrings.getString("MS_LABEL_NORMAL"));
        captionsPanel.add(maxLabel);

        jLabel1.setText(OStrings.getString("MS_HINT_MIN"));
        captionsPanel.add(jLabel1);

        jLabel2.setHorizontalAlignment(SwingConstants.CENTER);
        jLabel2.setText(OStrings.getString("MS_HINT_LOW"));
        captionsPanel.add(jLabel2);

        gridBagConstraints = new GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new Insets(0, 4, 4, 4);
        getContentPane().add(captionsPanel, gridBagConstraints);

        pack();
        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
        Dimension dialogSize = getSize();
        setLocation((screenSize.width-dialogSize.width)/2,(screenSize.height-dialogSize.height)/2);
    }//GEN-END:initComponents
	
	private void okButtonActionPerformed()//GEN-FIRST:event_okButtonActionPerformed
	{
		changed = similaritySlider.getValue() != value;
		value = similaritySlider.getValue();
		doClose();
	}//GEN-LAST:event_okButtonActionPerformed
	
	private void cancelButtonActionPerformed()//GEN-FIRST:event_cancelButtonActionPerformed
	{
		doClose();
	}//GEN-LAST:event_cancelButtonActionPerformed
	
	/** Closes the dialog */
	private void closeDialog()//GEN-FIRST:event_closeDialog
	{
		doClose();
	}//GEN-LAST:event_closeDialog
	
	private void doClose()
	{
		setVisible(false);
		dispose();
	}
	
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private JPanel buttonPanel;
    private JButton cancelButton;
    private JPanel captionsPanel;
    private JTextArea descriptionText;
    private JLabel jLabel1;
    private JLabel jLabel2;
    private JLabel maxLabel;
    private JLabel minLabel;
    private JLabel normLabel;
    private JButton okButton;
    private JSlider similaritySlider;
    // End of variables declaration//GEN-END:variables
	
}
